<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build a dataset from derived — build_from_derived • metatools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a dataset from derived — build_from_derived"><meta name="description" content="This function builds a dataset out of the columns that just need to be pulled
through. So any variable that has a derivation in the format of
'dataset.variable' will be pulled through to create the new dataset. When
there are multiple datasets present, they will be joined by the shared
key_seq variables. These columns are often called 'Predecessors' in ADaM,
but this is not universal so that is optional to specify."><meta property="og:description" content="This function builds a dataset out of the columns that just need to be pulled
through. So any variable that has a derivation in the format of
'dataset.variable' will be pulled through to create the new dataset. When
there are multiple datasets present, they will be joined by the shared
key_seq variables. These columns are often called 'Predecessors' in ADaM,
but this is not universal so that is optional to specify."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metatools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/metatools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build a dataset from derived</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/metatools/blob/main/R/build.R" class="external-link"><code>R/build.R</code></a></small>
      <div class="d-none name"><code>build_from_derived.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function builds a dataset out of the columns that just need to be pulled
through. So any variable that has a derivation in the format of
'dataset.variable' will be pulled through to create the new dataset. When
there are multiple datasets present, they will be joined by the shared
<code>key_seq</code> variables. These columns are often called 'Predecessors' in ADaM,
but this is not universal so that is optional to specify.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_from_derived</span><span class="op">(</span></span>
<span>  <span class="va">metacore</span>,</span>
<span>  <span class="va">ds_list</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predecessor_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-metacore">metacore<a class="anchor" aria-label="anchor" href="#arg-metacore"></a></dt>
<dd><p>metacore object that contains the specifications for the
dataset of interest.</p></dd>


<dt id="arg-ds-list">ds_list<a class="anchor" aria-label="anchor" href="#arg-ds-list"></a></dt>
<dd><p>Named list of datasets that are needed to build the from. If
the list is unnamed,then it will use the names of the objects.</p></dd>


<dt id="arg-dataset-name">dataset_name<a class="anchor" aria-label="anchor" href="#arg-dataset-name"></a></dt>
<dd><p>Optional string to specify the dataset that is being
built. This is only needed if the metacore object provided hasn't already
been subsetted.</p></dd>


<dt id="arg-predecessor-only">predecessor_only<a class="anchor" aria-label="anchor" href="#arg-predecessor-only"></a></dt>
<dd><p>By default <code>TRUE</code>, so only variables with the origin
of 'Predecessor' will be used. If <code>FALSE</code> any derivation matching the
dataset.variable will be used.</p></dd>


<dt id="arg-keep">keep<a class="anchor" aria-label="anchor" href="#arg-keep"></a></dt>
<dd><p>String to determine which columns from the original datasets
  should be kept
  - "FALSE" (default):  only columns that are also present in the ADaM
                           specification are kept in the output.
  - "ALL":              all original columns are carried through to the
                           ADaM, including those that have been renamed.
                           e.g. if DM.ARM is a predecessor to DM.TRT01P,
                           both ARM and TRT01P will be present as columns
                           in the ADaM output.
  - "PREREQUISITE":     columns are retained if they are required for future
                           derivations in the specification. Additional
                           prerequisite columns are identified as columns
                           that appear in the 'derivation' column of the
                           metacore object, but not as direct predecessors.
                           Predecessors are defined as columns where the
                           derivation is a 1:1 copy of a column in a source
                           dataset.</p>
<p>e.g. derivation = "VS.VSTESTCD" is a predecessor,
                           while derivation = "Value of VS.VSSTRESN where
                           VS.VSTESTCD == 'Heart Rate'" contains both
                           VS.VSTESTCD and VS.VSSTRESN as prerequisites, and
                           these columns will be kept through to the ADaM.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>dataset</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atorus-research.github.io/metacore/" class="external-link">metacore</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://atorus-research.github.io/metacore/reference/metacore_example.html" class="external-link">metacore_example</a></span><span class="op">(</span><span class="st">"pilot_ADaM.rda"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="va">metacore</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ds_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DM <span class="op">=</span> <span class="fu"><a href="https://haven.tidyverse.org/reference/read_xpt.html" class="external-link">read_xpt</a></span><span class="op">(</span><span class="fu"><a href="metatools_example.html">metatools_example</a></span><span class="op">(</span><span class="st">"dm.xpt"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">build_from_derived</span><span class="op">(</span><span class="va">spec</span>, <span class="va">ds_list</span>, predecessor_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 306 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID     USUBJID SUBJID SITEID ARM   TRT01P   AGE AGEU  RACE  SEX   ETHNIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> CDISCPILOT… 01-701… 1015   701    Plac… Place…    63 YEARS WHITE F     HISPA…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> CDISCPILOT… 01-701… 1023   701    Plac… Place…    64 YEARS WHITE M     HISPA…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> CDISCPILOT… 01-701… 1028   701    Xano… Xanom…    71 YEARS WHITE M     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> CDISCPILOT… 01-701… 1033   701    Xano… Xanom…    74 YEARS WHITE M     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> CDISCPILOT… 01-701… 1034   701    Xano… Xanom…    77 YEARS WHITE F     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> CDISCPILOT… 01-701… 1047   701    Plac… Place…    85 YEARS WHITE F     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> CDISCPILOT… 01-701… 1057   701    Scre… Scree…    59 YEARS WHITE F     HISPA…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> CDISCPILOT… 01-701… 1097   701    Xano… Xanom…    68 YEARS WHITE M     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> CDISCPILOT… 01-701… 1111   701    Xano… Xanom…    81 YEARS WHITE F     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> CDISCPILOT… 01-701… 1115   701    Xano… Xanom…    84 YEARS WHITE M     NOT H…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 296 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: DTHFL &lt;chr&gt;, RFSTDTC &lt;chr&gt;, RFENDTC &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Building an ADaM (ADVS) from multiple input datasets, keeping columns</span></span></span>
<span class="r-in"><span><span class="co"># needed for future transformations</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://atorus-research.github.io/metacore/" class="external-link">metacore</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">safetyData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://atorus-research.github.io/metacore/reference/metacore_example.html" class="external-link">metacore_example</a></span><span class="op">(</span><span class="st">"pilot_ADaM.rda"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="va">metacore</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://atorus-research.github.io/metacore/reference/select_dataset.html" class="external-link">select_dataset</a></span><span class="op">(</span><span class="st">"ADVS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ds_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"VS"</span> <span class="op">=</span> <span class="fu">safetyData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/safetyData/man/sdtm_vs.html" class="external-link">sdtm_vs</a></span>,<span class="st">"ADSL"</span> <span class="op">=</span> <span class="fu">safetyData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/safetyData/man/adam_adsl.html" class="external-link">adam_adsl</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">build_from_derived</span><span class="op">(</span><span class="va">spec</span>,</span></span>
<span class="r-in"><span>                   <span class="va">ds_list</span>,</span></span>
<span class="r-in"><span>                   predecessor_only <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                   keep <span class="op">=</span> <span class="st">"PREREQUISITE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 29,643 × 27</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID      SITEID USUBJID       AGE AGEGR1 AGEGR1N RACE  RACEN SEX   SAFFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> CDISCPILOT01 701    01-701-1015    63 &lt;65          1 WHITE     1 F     Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 29,633 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 17 more variables: TRTSDT &lt;date&gt;, TRTEDT &lt;date&gt;, TRTP &lt;chr&gt;, TRTPN &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   TRTA &lt;dbl&gt;, TRTAN &lt;dbl&gt;, PARAMCD &lt;chr&gt;, ADY &lt;int&gt;, ATPT &lt;chr&gt;, AVAL &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   BASETYPE &lt;chr&gt;, VISITNUM &lt;dbl&gt;, VISIT &lt;chr&gt;, VSSEQ &lt;int&gt;, ABLFL &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   VSDTC &lt;chr&gt;, VSSTRESN &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christina Fillmore, Mike Stackhouse, Jana Stoilova, Tamara Senior, GlaxoSmithKline LLC, F. Hoffmann-La Roche AG, Atorus Research LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

